<div class="post-share">
<div class="post-share">
  <h3>分享文章</h3>
  <div class="share-buttons">
    <!-- 打赏作者 -->
    <button class="share-button reward-button" title="打赏作者">
      <i class="fas fa-coffee"></i>
      <span>打赏作者</span>
    </button>

    <!-- 微信分享 -->
    <button class="share-button wechat-share" title="分享到微信" data-url="{{ page.url | absolute_url }}" data-title="{{ page.title }}">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
        <path d="M13.601 2.326A7.854 7.854 0 0 0 7.994 0C3.627 0 .068 3.558.064 7.926c0 1.399.366 2.76 1.057 3.965L0 16l4.204-1.102a7.933 7.933 0 0 0 3.79.965h.004c4.368 0 7.926-3.558 7.93-7.93A7.898 7.898 0 0 0 13.6 2.326zM7.994 14.521a6.573 6.573 0 0 1-3.356-.92l-.24-.144-2.494.654.666-2.433-.156-.251a6.56 6.56 0 0 1-1.007-3.505c0-3.626 2.957-6.584 6.591-6.584a6.56 6.56 0 0 1 4.66 1.931 6.557 6.557 0 0 1 1.928 4.66c-.004 3.639-2.961 6.592-6.592 6.592zm3.615-4.934c-.197-.099-1.17-.578-1.353-.646-.182-.065-.315-.099-.445.099-.133.197-.513.646-.627.775-.114.133-.232.148-.43.05-.197-.1-.836-.308-1.592-.985-.59-.525-.985-1.175-1.103-1.372-.114-.198-.011-.304.088-.403.087-.088.197-.232.296-.346.1-.114.133-.198.198-.33.065-.134.034-.248-.015-.347-.05-.099-.445-1.076-.612-1.47-.16-.389-.323-.335-.445-.34-.114-.007-.247-.007-.38-.007a.729.729 0 0 0-.529.247c-.182.198-.691.677-.691 1.654 0 .977.71 1.916.81 2.049.098.133 1.394 2.132 3.383 2.992.47.205.84.326 1.129.418.475.152.904.129 1.246.08.38-.058 1.171-.48 1.338-.943.164-.464.164-.86.114-.943-.049-.084-.182-.133-.38-.232z"/>
      </svg>
      <span>微信</span>
    </button>

    <!-- 微博分享 -->
    <a href="https://service.weibo.com/share/share.php?url={{ page.url | absolute_url }}&title={{ page.title }}&pic={{ page.image | default: site.image | absolute_url }}&appkey=" target="_blank" rel="noopener noreferrer" class="share-button weibo-share" title="分享到微博">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
        <path d="M8.027 0a8 8 0 0 0-2.634 15.36c.065.01.128.015.196 0A8 8 0 0 0 8.027 0zm4.408 12.21a4.151 4.151 0 0 1-5.48 1.362 4.151 4.151 0 0 1-1.362-5.48 4.151 4.151 0 0 1 5.48-1.362 4.151 4.151 0 0 1 1.362 5.48zm1.743-6.913a5.318 5.318 0 0 1-4.417 2.394c.002-.018.003-.037.003-.056 0-.798.24-1.568.675-2.197-.12-.25-.247-.513-.373-.79h-.04c-.27.348-.617.637-1.016.847A5.318 5.318 0 0 1 1.743 5.3a5.318 5.318 0 0 1 2.394-4.417 5.318 5.318 0 0 1 4.417 2.394A5.318 5.318 0 0 1 14.178 5.3z"/>
      </svg>
      <span>微博</span>
    </a>

    <!-- QQ分享 -->
    <a href="https://connect.qq.com/widget/shareqq/index.html?url={{ page.url | absolute_url }}&sharesource=qzone&title={{ page.title }}&pics={{ page.image | default: site.image | absolute_url }}&flash=&site={{ site.title }}&summary={{ default:site.description }}&desc={{ default: site.description }}" target="_blank" rel="noopener noreferrer" class="share-button qq-share" title="分享到QQ">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
        <path d="M7.465 10.556c-.918 0-1.668-.75-1.668-1.668 0-.918.75-1.668 1.668-1.668.918 0 1.668.75 1.668 1.668 0 .918-.75 1.668-1.668 1.668zm0-2.224c-.31 0-.562.252-.562.562s.252.562.562.562.562-.252.562-.562-.252-.562-.562-.562z"/>
        <path d="M6.5 0C2.8 0 0 2.8 0 6.5c0 2.49 1.368 4.6 3.44 5.78.26.12.564.19.88.19.256 0 .513-.05.748-.15a5.33 5.33 0 0 0 1.645-.656 3.832 3.832 0 0 1-1.51-.674c-.174-.12-.334-.25-.48-.403a4.096 4.096 0 0 0 1.47.446c.76.01 1.466-.26 2.042-.69.576-.43 1.01-.99 1.277-1.69h-.781c-.263.49-.69.91-1.25.124a12.68 12.68 0 0 0-1.732 1.458 3.834 3.834 0 0 1-2.646-1.308c-.05-.06-.098-.12-.15-.182-.01-.01-.018-.02-.027-.028a4.408 4.408 0 0 0-.39.07c-.254.09-.49.198-.717.334-.21.12-.414.25-.602.395.215-.012.428-.035.638-.07.49-.077.93-.22 1.31-.428.38-.207.7-.458.945-.747a4.76 4.76 0 0 1-.89-.85c-.18-.27-.32-.56-.43-.874-.04-.1-.075-.2-.107-.302a4.588 4.588 0 0 0 1.56-.774 4.654 4.654 0 0 1-2.15-.526 4.73 4.73 0 0 1-.646-1.08c0-.134.013-.267.036-.397a4.412 4.412 0 0 1 1.902.567 4.42 4.42 0 0 0 2.76-.425c.66-.32 1.23-.8 1.69-.132.18-.03.357-.06.535-.098.555-.117 1.08-.19 1.603-.21a4.986 4.986 0 0 1-.81.62 9.73 9.73 0 0 0 2.96-1.153 9.24 9.24 0 0 0 2.532-2.732c.09-.23.166-.468.228-.713A9.536 9.536 0 0 1 16 6.5C16 2.8 13.2 0 9.5 0H6.5z"/>
      </svg>
      <span>QQ</span>
    </a>

    <!-- 复制链接 -->
    <button class="share-button copy-link" title="复制链接" data-url="{{ page.url | absolute_url }}">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
        <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/>
        <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/>
      </svg>
      <span>复制链接</span>
    </button>
  </div>

  <!-- 微信二维码 -->
  <div class="wechat-qrcode" style="display: none;">
    <div class="qrcode-container">
      <img id="wechat-qrcode-image" src="" alt="微信扫码分享"/>
      <p>微信扫一扫分享</p>
    </div>
  </div>

<script>
  // 复制链接功能
  document.querySelectorAll('.copy-link').forEach(button => {
    button.addEventListener('click', function() {
      const url = this.getAttribute('data-url');
      const buttonElement = this;
      
      if (navigator.clipboard && window.isSecureContext) {
        // 使用现代Clipboard API
        navigator.clipboard.writeText(url).then(() => {
          showCopySuccess(buttonElement);
        }).catch(err => {
          console.error('无法使用Clipboard API: ', err);
          fallbackCopyTextToClipboard(url, buttonElement);
        });
      } else {
        // 使用传统方法作为备用
        fallbackCopyTextToClipboard(url, buttonElement);
      }
    });
  });
  
  // 复制成功提示
  function showCopySuccess(button) {
    const originalText = button.querySelector('span').textContent;
    button.querySelector('span').textContent = '已复制!';
    setTimeout(() => {
      button.querySelector('span').textContent = originalText;
    }, 2000);
  }
  
  // 传统复制方法（备用）
  function fallbackCopyTextToClipboard(text, button) {
    const textArea = document.createElement('textarea');
    textArea.value = text;
    
    // 保证textArea在视口外
    textArea.style.position = 'fixed';
    textArea.style.left = '-999999px';
    textArea.style.top = '-999999px';
    
    document.body.appendChild(textArea);
    textArea.focus();
    textArea.select();
    
    try {
      const successful = document.execCommand('copy');
      if (successful) {
        showCopySuccess(button);
      } else {
        console.error('复制命令执行失败');
        button.querySelector('span').textContent = '复制失败';
        setTimeout(() => {
          button.querySelector('span').textContent = '复制链接';
        }, 2000);
      }
    } catch (err) {
      console.error('传统复制方法失败: ', err);
      button.querySelector('span').textContent = '复制失败';
      setTimeout(() => {
        button.querySelector('span').textContent = '复制链接';
      }, 2000);
    }
    
    document.body.removeChild(textArea);
  }

  // 微信分享功能 - 显示二维码
  document.querySelectorAll('.wechat-share').forEach(button => {
    button.addEventListener('click', function() {
      const url = this.getAttribute('data-url');
      const title = this.getAttribute('data-title');
      const qrcodeContainer = document.querySelector('.wechat-qrcode');
      const qrcodeImage = document.getElementById('wechat-qrcode-image');
      
      // 使用api生成二维码
      qrcodeImage.src = 'https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=' + encodeURIComponent(url);
      
      // 显示二维码
      qrcodeContainer.style.display = 'block';
      
      // 点击其他地方关闭二维码
      function closeQrcode(e) {
        if (!qrcodeContainer.contains(e.target) && e.target !== button && !button.contains(e.target)) {
          qrcodeContainer.style.display = 'none';
          document.removeEventListener('click', closeQrcode);
        }
      }
      
      setTimeout(() => {
        document.addEventListener('click', closeQrcode);
      }, 100);
    });
  });

  // 打赏作者功能
  document.querySelectorAll('.reward-button').forEach(button => {
    button.addEventListener('click', function() {
      const panel = document.createElement('div');
      panel.className = 'reward-panel';
      panel.id = 'rewardPanel';
      panel.innerHTML = `
        <div class="reward-content">
          <div class="reward-header">
            <h4>感谢您的支持！</h4>
            <button class="close-button" onclick="closeRewardPanel()">×</button>
          </div>
          
          <div class="reward-qr-codes">
            <div class="qr-code-item">
              <img src="{{ site.baseurl }}/assets/images/reward/reward_weixinpay.jpg" alt="微信支付">
              <p>微信支付</p>
            </div>
            
            <div class="qr-code-item">
              <img src="{{ site.baseurl }}/assets/images/reward/reward_ali_pay.jpg" alt="支付宝">
              <p>支付宝</p>
            </div>
          </div>
          
          <p class="reward-tip">您的支持是我创作的动力，谢谢！</p>
        </div>
      `;
      document.body.appendChild(panel);
      
      // 显示面板
      setTimeout(() => {
        panel.classList.add('show');
      }, 10);
    });
  });
  
  function closeRewardPanel() {
    const panel = document.getElementById('rewardPanel');
    if (panel) {
      panel.classList.remove('show');
      setTimeout(() => {
        panel.remove();
      }, 300);
    }
  }
  
  // 点击面板外部关闭
  document.addEventListener('click', function(event) {
    const panel = document.getElementById('rewardPanel');
    const button = document.querySelector('.reward-button');
    
    if (panel && !panel.contains(event.target) && event.target !== button && !button.contains(event.target)) {
      closeRewardPanel();
    }
  });
</script>

<style>
  /* 打赏按钮样式 */
  .share-button.reward-button {
    background-color: #ff6b6b;
    color: white;
  }
  
  .share-button.reward-button:hover {
    background-color: #ff5252;
  }
  
  /* 打赏面板样式 */
  .reward-panel {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 1000;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s ease, visibility 0.3s ease;
  }
  
  .reward-panel.show {
    opacity: 1;
    visibility: visible;
  }
  
  .reward-content {
    background-color: white;
    border-radius: 8px;
    padding: 2rem;
    max-width: 400px;
    width: 90%;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  }
  
  .reward-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1.5rem;
    border-bottom: 1px solid #eee;
    padding-bottom: 1rem;
  }
  
  .reward-header h4 {
    margin: 0;
    color: #333;
  }
  
  .close-button {
    background: none;
    border: none;
    font-size: 1.5rem;
    cursor: pointer;
    color: #999;
    padding: 0;
    width: 30px;
    height: 30px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    transition: all 0.3s ease;
  }
  
  .close-button:hover {
    background-color: #f5f5f5;
    color: #666;
  }
  
  .reward-qr-codes {
    display: flex;
    justify-content: space-around;
    margin-bottom: 1.5rem;
  }
  
  .qr-code-item {
    text-align: center;
  }
  
  .qr-code-item img {
    width: 150px;
    height: 150px;
    margin-bottom: 0.5rem;
  }
  
  .qr-code-item p {
    margin: 0;
    font-size: 0.9rem;
    color: #666;
  }
  
  .reward-tip {
    text-align: center;
    color: #999;
    font-size: 0.85rem;
    margin: 0;
  }
  
  /* 响应式设计 */
  @media (max-width: 480px) {
    .reward-qr-codes {
      flex-direction: column;
      align-items: center;
    }
    
    .qr-code-item {
      margin-bottom: 1rem;
    }
    
    .qr-code-item img {
      width: 120px;
      height: 120px;
    }
  }
</style>