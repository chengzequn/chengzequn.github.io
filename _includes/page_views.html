<div class="page-views">
  <div class="page-views-content">
    <p>🔥 热门文章阅读排行</p>
    <div class="page-views-list">
      <!-- 只显示前5篇文章 -->
      {% assign counter = 0 %}
      {% for post in site.posts %}
        {% if counter < 5 %}
        <div class="page-view-item">
          <span class="page-view-count">{{ counter | plus: 1 }}.</span>
          <a href="{{ post.url }}" class="page-view-title" title="{{ post.title }}">{{ post.title | truncate: 20 }}</a>
          <span class="page-view-number">
            <i class="far fa-eye"></i> <span class="post-views" data-post-url="{{ post.url }}">-</span>
          </span>
        </div>
        {% assign counter = counter | plus: 1 %}
        {% endif %}
      {% endfor %}
    </div>
    <p class="page-views-date">统计时间: {{ site.time | date: "%Y年%m月%d日" }}</p>
  </div>
</div>

<script>
  // 本地阅读次数统计脚本
  (function() {
    // 页面加载后获取每篇文章的阅读次数
    window.addEventListener('load', function() {
      document.querySelectorAll('.post-views').forEach(function(element) {
        var postUrl = element.getAttribute('data-post-url');
        // 获取URL的最后一部分作为文章标识
        var postId = postUrl.split('/').filter(Boolean).join('-');
        // 尝试从localStorage获取阅读次数
        var views = localStorage.getItem('post_views_' + postId);
        if (views) {
          element.textContent = views;
        } else {
          // 如果localStorage中没有，设置为随机数作为模拟数据
          var randomViews = Math.floor(Math.random() * 1000) + 10;
          localStorage.setItem('post_views_' + postId, randomViews);
          element.textContent = randomViews;
        }
      });
    });
  })();
</script>

<style>
  .page-views-content {
    padding: 10px;
    background-color: rgba(59, 130, 246, 0.05);
    border-radius: 0.5rem;
    border-left: 3px solid #3b82f6;
  }
  
  .page-views-content p {
    margin-bottom: 8px;
    line-height: 1.5;
  }
  
  .page-views-content p:last-child {
    margin-bottom: 0;
  }
  
  .page-views-list {
    margin: 10px 0;
  }
  
  .page-view-item {
    display: flex;
    align-items: center;
    padding: 5px 0;
    font-size: 0.875rem;
  }
  
  .page-view-count {
    width: 20px;
    text-align: right;
    margin-right: 8px;
    color: #3b82f6;
    font-weight: bold;
  }
  
  .page-view-title {
    flex: 1;
    margin-right: 8px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    color: inherit;
    text-decoration: none;
    transition: all 0.2s ease;
  }
  
  .page-view-title:hover {
    color: #3b82f6;
    background-color: rgba(59, 130, 246, 0.1);
    padding: 2px 4px;
    border-radius: 4px;
  }
  
  .page-view-number {
    color: #4a5568;
    font-size: 0.8125rem;
  }
  
  .page-views-date {
    font-size: 0.875rem;
    color: #4a5568;
    font-style: italic;
  }
</style>